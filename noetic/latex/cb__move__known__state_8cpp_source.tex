\hypertarget{cb__move__known__state_8cpp_source}{}\doxysection{cb\+\_\+move\+\_\+known\+\_\+state.\+cpp}
\label{cb__move__known__state_8cpp_source}\index{smacc\_client\_library/move\_group\_interface\_client/src/move\_group\_interface\_client/client\_behaviors/cb\_move\_known\_state.cpp@{smacc\_client\_library/move\_group\_interface\_client/src/move\_group\_interface\_client/client\_behaviors/cb\_move\_known\_state.cpp}}
\mbox{\hyperlink{cb__move__known__state_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00001}00001 \textcolor{comment}{/*****************************************************************************************************************}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00002}00002 \textcolor{comment}{ * ReelRobotix Inc. -\/ Software License Agreement      Copyright (c) 2018-\/2020}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00003}00003 \textcolor{comment}{ *   Authors: Pablo Inigo Blasco, Brett Aldrich}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00004}00004 \textcolor{comment}{ *}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00005}00005 \textcolor{comment}{ ******************************************************************************************************************/}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{cb__move__known__state_8h}{move\_group\_interface\_client/client\_behaviors/cb\_move\_known\_state.h}}>}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00008}00008 \textcolor{preprocessor}{\#include <yaml-\/cpp/yaml.h>}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00009}00009 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00010}00010 \textcolor{preprocessor}{\#include <ros/package.h>}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00011}00011 \textcolor{preprocessor}{\#include <experimental/filesystem>}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00013}00013 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecl__move__group__interface}{cl\_move\_group\_interface}}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00014}00014 \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00015}\mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveKnownState_abd9a6ff0a5aa0333852f5ea1522bc932}{00015}} \mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveKnownState_abd9a6ff0a5aa0333852f5ea1522bc932}{CbMoveKnownState::CbMoveKnownState}}(std::string pkg, std::string config\_path)}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00016}00016   : \mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveJoints}{CbMoveJoints}}(loadJointStatesFromFile(pkg, config\_path))}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00017}00017 \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00018}00018 \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00020}\mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveKnownState_a50cb63899a41d9e9cee7c9af3e8160d5}{00020}} \mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveKnownState_a50cb63899a41d9e9cee7c9af3e8160d5}{CbMoveKnownState::\string~CbMoveKnownState}}()}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00021}00021 \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00023}00023 \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00025}00025 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00026}\mbox{\hyperlink{cb__move__known__state_8cpp_a8f298134094422968fe45aeb8b32b9aa}{00026}} \textcolor{preprocessor}{\#define HAVE\_NEW\_YAMLCPP}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00027}\mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveKnownState_a3998d6e04560c6c4f36a3cb6f6a86780}{00027}} std::map<std::string, double> \mbox{\hyperlink{classcl__move__group__interface_1_1CbMoveKnownState_a3998d6e04560c6c4f36a3cb6f6a86780}{CbMoveKnownState::loadJointStatesFromFile}}(std::string pkg, std::string filepath)}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00028}00028 \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00029}00029   \textcolor{keyword}{auto} pkgpath = ros::package::getPath(pkg);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00030}00030   std::map<std::string, double> jointStates;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00032}00032   \textcolor{keywordflow}{if}(pkgpath == \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00033}00033   \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00034}00034     ROS\_ERROR\_STREAM(\textcolor{stringliteral}{"{}[CbMoveKnownState] package not found for the known poses file: "{}} << pkg << std::endl << \textcolor{stringliteral}{"{} [IGNORING BEHAVIOR]"{}});}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00035}00035     \textcolor{keywordflow}{return} jointStates;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00036}00036   \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00038}00038   filepath =  pkgpath +\textcolor{stringliteral}{"{}/"{}} + filepath;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00041}00041   ROS\_INFO(\textcolor{stringliteral}{"{}[CbMoveKnownState] Opening file with joint known state: \%s"{}},  filepath.c\_str());}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00043}00043 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00044}00044   \textcolor{keywordflow}{if}(std::experimental::filesystem::exists(filepath))}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00045}00045   \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00046}00046     ROS\_INFO\_STREAM(\textcolor{stringliteral}{"{}[CbMoveKnownState] known state file exists: "{}} << filepath);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00047}00047   \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00048}00048   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00049}00049   \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00050}00050     ROS\_ERROR\_STREAM(\textcolor{stringliteral}{"{}[CbMoveKnownState] known state file does not exists: "{}} << filepath);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00051}00051   \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00053}00053   std::ifstream ifs(filepath.c\_str(), std::ifstream::in);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00054}00054   \textcolor{keywordflow}{if} (ifs.good() == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00055}00055   \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00056}00056     ROS\_ERROR(\textcolor{stringliteral}{"{}[CbMoveKnownState] Error opening file with joint known states: \%s"{}},  filepath.c\_str());}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00057}00057     \textcolor{keywordflow}{throw} std::string(\textcolor{stringliteral}{"{}joint state files not found"{}});}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00058}00058   \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00060}00060   \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00061}00061   \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00062}00062 \textcolor{preprocessor}{\#ifdef HAVE\_NEW\_YAMLCPP}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00063}00063     YAML::Node node = YAML::Load(ifs);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00064}00064 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00065}00065     YAML::Parser parser(ifs);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00066}00066     parser.GetNextDocument(node);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00067}00067 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00069}00069 \textcolor{preprocessor}{\#ifdef HAVE\_NEW\_YAMLCPP}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00070}00070     \textcolor{keyword}{const} YAML::Node \&wp\_node\_tmp = node[\textcolor{stringliteral}{"{}joint\_states"{}}];}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00071}00071     \textcolor{keyword}{const} YAML::Node *wp\_node = wp\_node\_tmp ? \&wp\_node\_tmp : NULL;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00072}00072 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00073}00073     \textcolor{keyword}{const} YAML::Node *wp\_node = node.FindValue(\textcolor{stringliteral}{"{}waypoints"{}});}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00074}00074 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00076}00076     \textcolor{keywordflow}{if} (wp\_node != NULL)}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00077}00077     \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00078}00078       \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00079}00079       \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00080}00080         \textcolor{keywordflow}{for}(YAML::const\_iterator it=wp\_node-\/>begin();it != wp\_node-\/>end();++it)}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00081}00081         \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00082}00082           std::string key = it-\/>first.as<std::string>();}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00083}00083           \textcolor{keywordtype}{double} value = it-\/>second.as<\textcolor{keywordtype}{double}>();}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00084}00084           ROS\_DEBUG\_STREAM(\textcolor{stringliteral}{"{} joint -\/ "{}} << key << \textcolor{stringliteral}{"{}: "{}} << value);}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00085}00085           jointStates[key] = value;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00086}00086         \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00088}00088         \textcolor{keywordflow}{return} jointStates;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00089}00089       \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00090}00090       \textcolor{keywordflow}{catch}(std::exception\& ex)}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00091}00091       \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00092}00092         ROS\_ERROR(\textcolor{stringliteral}{"{}trying to convert to map, failed, errormsg: \%s"{}}, ex.what());}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00093}00093       \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00095}00095       ROS\_INFO\_STREAM(\textcolor{stringliteral}{"{}Parsed "{}} << jointStates.size() << \textcolor{stringliteral}{"{} joint entries."{}});}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00096}00096     \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00097}00097     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00098}00098     \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00099}00099       ROS\_WARN\_STREAM(\textcolor{stringliteral}{"{}Couldn't find any jointStates in the provided yaml file."{}});}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00100}00100     \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00101}00101   \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00102}00102   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} YAML::ParserException \&ex)}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00103}00103   \{}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00104}00104     ROS\_ERROR\_STREAM(\textcolor{stringliteral}{"{}Error loading the Waypoints YAML file. Incorrect syntax: "{}} << ex.what());}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00105}00105   \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00106}00106   \textcolor{keywordflow}{return} jointStates;}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00107}00107 \}}
\DoxyCodeLine{\Hypertarget{cb__move__known__state_8cpp_source_l00108}00108 \}  \textcolor{comment}{// namespace cl\_move\_group\_interface}}

\end{DoxyCode}
