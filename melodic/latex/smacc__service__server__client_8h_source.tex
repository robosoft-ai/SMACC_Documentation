\hypertarget{smacc__service__server__client_8h_source}{}\doxysection{smacc\+\_\+service\+\_\+server\+\_\+client.\+h}
\label{smacc__service__server__client_8h_source}\index{smacc/include/smacc/client\_bases/smacc\_service\_server\_client.h@{smacc/include/smacc/client\_bases/smacc\_service\_server\_client.h}}
\mbox{\hyperlink{smacc__service__server__client_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00001}00001 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00003}00003 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{smacc__client_8h}{smacc/smacc\_client.h}}>}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00004}00004 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{smacc__signal_8h}{smacc/smacc\_signal.h}}>}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00005}00005 \textcolor{preprocessor}{\#include <std\_srvs/Empty.h>}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00007}00007 \textcolor{preprocessor}{\#include <boost/optional/optional\_io.hpp>}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00009}00009 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacesmacc}{smacc}} \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00010}00010 \textcolor{keyword}{namespace }client\_bases \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00011}00011 \textcolor{keyword}{template} <\textcolor{keyword}{typename} TService>}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00012}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient}{00012}} \textcolor{keyword}{class }\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient}{SmaccServiceServerClient}} : \textcolor{keyword}{public} \mbox{\hyperlink{classsmacc_1_1ISmaccClient}{smacc::ISmaccClient}} \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00013}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a9778b3fc53f067a890e2731a52cd9f12}{00013}}   \textcolor{keyword}{using }\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a9778b3fc53f067a890e2731a52cd9f12}{TServiceRequest}} = \textcolor{keyword}{typename} TService::Request;}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00014}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a61f1cab2c65d38d5417183887f186dce}{00014}}   \textcolor{keyword}{using }\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a61f1cab2c65d38d5417183887f186dce}{TServiceResponse}} = \textcolor{keyword}{typename} TService::Response;}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00016}00016  \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00017}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aea8173dcac027790112b7f42c3d2d224}{00017}}   boost::optional<std::string> \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aea8173dcac027790112b7f42c3d2d224}{serviceName\_}};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00018}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a8aebced82e5c5bd63ef66cd6f2d794a3}{00018}}   \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a8aebced82e5c5bd63ef66cd6f2d794a3}{SmaccServiceServerClient}}() \{ \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aa0dc1ec67303da8b918861d10992cea0}{initialized\_}} = \textcolor{keyword}{false}; \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00019}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a157e35fc383b7d9bfc5ec6759dbcaa04}{00019}}   \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a157e35fc383b7d9bfc5ec6759dbcaa04}{SmaccServiceServerClient}}(std::string service\_name) \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00020}00020     \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aea8173dcac027790112b7f42c3d2d224}{serviceName\_}} = service\_name;}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00021}00021     \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aa0dc1ec67303da8b918861d10992cea0}{initialized\_}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00022}00022   \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00024}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_adcb98a63550ebf9852d3bd4b1b4655bd}{00024}}   \textcolor{keyword}{virtual} \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_adcb98a63550ebf9852d3bd4b1b4655bd}{\string~SmaccServiceServerClient}}() \{ \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a7094af7e5fcc1d0cf02a8890d2f066b1}{server\_}}.shutdown(); \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00025}00025 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00026}00026   \mbox{\hyperlink{classsmacc_1_1SmaccSignal}{smacc::SmaccSignal}}<\mbox{\hyperlink{classbool}{bool}}(\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a9778b3fc53f067a890e2731a52cd9f12}{TServiceRequest}}\&, std::shared\_ptr<TServiceResponse>)>}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00027}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aaea4a2e28c8fda0381c830ca86550d99}{00027}}       \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aaea4a2e28c8fda0381c830ca86550d99}{onServiceRequestReceived\_}};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00029}00029   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00030}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_ad388351ce0f1e50ccce92b2abbdd77d4}{00030}}   boost::signals2::connection \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_ad388351ce0f1e50ccce92b2abbdd77d4}{onServiceRequestReceived}}(}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00031}00031       \textcolor{keywordtype}{bool} (T::*callback)(\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a9778b3fc53f067a890e2731a52cd9f12}{TServiceRequest}}\&, std::shared\_ptr<TServiceResponse>),}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00032}00032       T* \textcolor{keywordtype}{object}) \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00033}00033     \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classsmacc_1_1ISmaccClient_aec51d4712404cb9882b86e4c854bb93a}{getStateMachine}}()-\/>\mbox{\hyperlink{classsmacc_1_1ISmaccStateMachine_adf0f42ade0c65cc471960fe2a7c42da2}{createSignalConnection}}(}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00034}00034         \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aaea4a2e28c8fda0381c830ca86550d99}{onServiceRequestReceived\_}}, callback, \textcolor{keywordtype}{object});}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00035}00035   \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00037}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_ab05e6e4f2125dde4aa9eaa1f6be536fa}{00037}}   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_ab05e6e4f2125dde4aa9eaa1f6be536fa}{initialize}}()\textcolor{keyword}{ override }\{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00038}00038     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aa0dc1ec67303da8b918861d10992cea0}{initialized\_}}) \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00039}00039       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aea8173dcac027790112b7f42c3d2d224}{serviceName\_}}) \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00040}00040         ROS\_ERROR(\textcolor{stringliteral}{"{}service server with no service name set. Skipping."{}});}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00041}00041       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00042}00042         ROS\_INFO\_STREAM(\textcolor{stringliteral}{"{}["{}} << this-\/>\mbox{\hyperlink{classsmacc_1_1ISmaccClient_a8c3ce19f182e71909c5dc6263d25be69}{getName}}()}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00043}00043                             << \textcolor{stringliteral}{"{}] Client Service: "{}} << serviceName\_);}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00045}00045         \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a7094af7e5fcc1d0cf02a8890d2f066b1}{server\_}} = \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a72137bfb13ab8c18ad53c7e73f497807}{nh\_}}.advertiseService(}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00046}00046             *\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aea8173dcac027790112b7f42c3d2d224}{serviceName\_}}, \&\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient}{SmaccServiceServerClient<TService>::serviceCallback}},}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00047}00047             \textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00048}00048         this-\/>\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aa0dc1ec67303da8b918861d10992cea0}{initialized\_}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00049}00049       \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00050}00050     \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00051}00051   \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00053}00053  \textcolor{keyword}{protected}:}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00054}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a72137bfb13ab8c18ad53c7e73f497807}{00054}}   ros::NodeHandle \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a72137bfb13ab8c18ad53c7e73f497807}{nh\_}};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00056}00056  \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00057}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_af10cc35ff06a17a27da97f29f8ac9cb5}{00057}}   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_af10cc35ff06a17a27da97f29f8ac9cb5}{serviceCallback}}(\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a9778b3fc53f067a890e2731a52cd9f12}{TServiceRequest}}\& req, \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a61f1cab2c65d38d5417183887f186dce}{TServiceResponse}}\& res) \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00058}00058     std::shared\_ptr<TServiceResponse> response\{\textcolor{keyword}{new} \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a61f1cab2c65d38d5417183887f186dce}{TServiceResponse}}\};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00059}00059     \textcolor{keyword}{auto} ret\_val = \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aaea4a2e28c8fda0381c830ca86550d99}{onServiceRequestReceived\_}}(req, response);}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00060}00060     \textcolor{keywordflow}{if} (!ret\_val)  \textcolor{comment}{// Check if response is empty}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00061}00061     \{}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00062}00062       ROS\_WARN(}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00063}00063           \textcolor{stringliteral}{"{}No return value received from service call. Are you returning a "{}}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00064}00064           \textcolor{stringliteral}{"{}value?"{}});}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00065}00065       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00066}00066     \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00067}00067     res = *response;}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00068}00068     \textcolor{keywordflow}{return} *ret\_val;}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00069}00069   \}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00070}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a7094af7e5fcc1d0cf02a8890d2f066b1}{00070}}   ros::ServiceServer \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_a7094af7e5fcc1d0cf02a8890d2f066b1}{server\_}};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00071}\mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aa0dc1ec67303da8b918861d10992cea0}{00071}}   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classsmacc_1_1client__bases_1_1SmaccServiceServerClient_aa0dc1ec67303da8b918861d10992cea0}{initialized\_}};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00072}00072 \};}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00073}00073 \}  \textcolor{comment}{// namespace client\_bases}}
\DoxyCodeLine{\Hypertarget{smacc__service__server__client_8h_source_l00074}00074 \}  \textcolor{comment}{// namespace smacc}}

\end{DoxyCode}
